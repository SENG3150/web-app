<div class="ibox">
    <div class="ibox-title">
        <h5>Machines</h5>
        <div class="ibox-tools" ibox-tools>
            <a class="collapse-link">
                <i class="fa fa-chevron-up"></i>
            </a>
        </div>
    </div>
    <div class="ibox-content">
        <table class="table">
            <thead>
            <tr>
                <th>Time Created</th>
                <th>Time Scheduled</th>
                <th>Time Started</th>
                <th>Time Completed</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td ng-if="inspection.timeCreated != null">
                    {{ moment(inspection.timeCreated).format("dddd, MMMM Do YYYY, h:mm:ss a") }}
                </td>
                <td ng-if="inspection.timeCreated == null">
                    Not Created
                </td>

                <td ng-if="inspection.timeScheduled != null">
                    {{ moment(inspection.timeScheduled).format("dddd, MMMM Do YYYY, h:mm:ss a") }}
                </td>
                <td ng-if="inspection.timeScheduled == null">
                    No Schedule
                </td>

                <td ng-if="inspection.timeStarted != null">
                    {{ moment(inspection.timeStarted).format("dddd, MMMM Do YYYY, h:mm:ss a") }}
                </td>
                <td ng-if="inspection.timeStarted == null">
                    Not Started
                </td>

                <td ng-if="inspection.timeCompleted != null">
                    {{ moment(inspection.timeCompleted).format("dddd, MMMM Do YYYY, h:mm:ss a") }}
                </td>
                <td ng-if="inspection.timeCompleted == null">
                    Not Completed
                </td>
            </tr>
            </tbody>
        </table>

        <a ui-sref="domainExpert-inspections-report({ id: inspection.id })" class="btn btn-primary">View Report</a>

        <h1>Inspection Comments</h1>
        <div class="panel panel-success" ng-repeat="comment in inspection.comments">
            <div class="panel-heading">
                By: {{comment.author.name}}
                <div class="panel-title pull-right">
                    Time Commented: {{moment(comment.timeCommented).format("dddd, MMMM Do YYYY, h:mm:ss a")}}
                </div>
            </div>
            <div class="panel-body">{{comment.text}}</div>
        </div>

        <!--add a inspection comment-->
        <div add-comment location="inspection" location-id="{{inspection.id}}"></div>

        <h1>Inspection Results</h1>

        <!-- major assembly panel -->
        <div ng-app id="ng-app" class="panel panel-primary" ng-repeat="majorAssembly in inspection.majorAssemblies">
            <div class="panel-heading">
                <a href="#" ng-model="collapsed" style="color:white" ng-click="collapsed=!collapsed">
                    {{majorAssembly.majorAssembly.name}}
                </a>
            </div>

            <div ng-show="collapsed" class="panel-body">

                <!-- major assembly comment -->
                <div ng-app id="ng-majorComment" class="panel panel-success" ng-repeat="comment in majorAssembly.comments">
                    <div class="panel-heading">
                        <a href="#" ng-model="collapsed" class="text-success" style="color:white"
                           ng-click="collapsedComment=!collapsedComment">
                            Comment by: {{comment.author.name}}
                            <div class="panel-title pull-right">
                                Time Commented: {{moment(comment.timeCommented).format("dddd, MMMM Do YYYY, h:mm:ss a")}}
                            </div>
                        </a>
                    </div>
                    <div ng-show="collapsedComment" class="panel-body">{{comment.text}}</div>
                </div>

                <!--Add a major assembly comment -->
                <div add-comment location="majorAssembly" location-id="{{majorAssembly.id}}"></div>


                <!-- sub assembly panel -->
                <div ng-app id="ng-subAssemly" class="panel panel-info" ng-repeat="subAssembly in majorAssembly.subAssemblies">
                    <div class="panel-heading">
                        <a href="#" ng-model="collapsed" style="color:white"
                           ng-click="collapsedSubAssembly=!collapsedSubAssembly">
                            {{subAssembly.subAssembly.name}}
                        </a>
                    </div>


                    <div ng-show="collapsedSubAssembly" class="panel-body">
                        <!-- Machine General Test -->
                        <div ng-if="subAssembly.machineGeneralTest != null">
                            <div class="panel panel-warning">
                                <div class="panel-heading">Machine General Test</div>
                                <div class="panel-body">
                                    <table class="table">
                                        <thead>
                                        <th>Test Type</th>
                                        <th> Doc Link</th>
                                        </thead>
                                        <tbody>
                                        <td>{{subAssembly.machineGeneralTest.testType}}</td>
                                        <td>{{subAssembly.machineGeneralTest.docLink}}</td>
                                        </tbody>
                                    </table>
                                    <hr/>
                                    <h3>Action Item</h3>
                                    <!--Action Item-->
                                    <table class="table">
                                        <thead>
                                        <th>Status</th>
                                        <th>Issue</th>
                                        <th>Action</th>
                                        <th>Technician</th>
                                        <th>Time Actioned</th>
                                        </thead>
                                        <tbody>
                                        <td>{{subAssembly.machineGeneralTest.actionItem.status}}</td>
                                        <td>{{subAssembly.machineGeneralTest.actionItem.issue}}</td>
                                        <td>{{subAssembly.machineGeneralTest.actionItem.action}}</td>
                                        <td>{{subAssembly.machineGeneralTest.actionItem.technician.name}}</td>
                                        <td>{{moment(subAssembly.machineGeneralTest.actionItem.timeActioned).format("dddd, MMMM
                                            Do YYYY, h:mm:ss a")}}
                                        </td>
                                        </tbody>
                                    </table>
                                    <div ng-app id="ng-subComment" class="panel panel-success"
                                         ng-repeat="comment in subAssembly.machineGeneralTest.comments">
                                        <div class="panel-heading">
                                            <a href="#" ng-model="collapsed" style="color:white" class="text-success"
                                               ng-click="collapsedComment=!collapsedComment">
                                                Comment by: {{comment.author.name}}
                                                <div class="panel-title pull-right">
                                                    Time Commented: {{moment(comment.timeCommented).format("dddd, MMMM Do YYYY,
                                                    h:mm:ss a")}}
                                                </div>
                                            </a>
                                        </div>
                                        <div ng-show="collapsedComment" class="panel-body">{{comment.text}}</div>
                                    </div>

                                    <!--Add a machine general test comment -->
                                    <div add-comment location="machineGeneralTest" location-id="{{subAssembly.machineGeneralTest.id}}"></div>
                                </div>
                            </div>

                        </div>
                        <!-- Oil Test -->
                        <div ng-if="subAssembly.oilTest != null">
                            <div class="panel panel-warning">
                                <div class="panel-heading">Oil Test</div>
                                <div class="panel-body">
                                    <table class="table">
                                        <thead>
                                        <th>Lead</th>
                                        <th>Copper</th>
                                        <th>Tin</th>
                                        <th>Iron</th>
                                        <th>pq90</th>
                                        <th>Silicon</th>
                                        <th>Sodium</th>
                                        <th>Aluminium</th>
                                        <th>Water</th>
                                        <th>Viscosity</th>
                                        </thead>
                                        <tbody>
                                        <td>{{subAssembly.oilTest.lead}}</td>
                                        <td>{{subAssembly.oilTest.copper}}</td>
                                        <td>{{subAssembly.oilTest.tin}}</td>
                                        <td>{{subAssembly.oilTest.iron}}</td>
                                        <td>{{subAssembly.oilTest.pq90}}</td>
                                        <td>{{subAssembly.oilTest.silicon}}</td>
                                        <td>{{subAssembly.oilTest.sodium}}</td>
                                        <td>{{subAssembly.oilTest.aluminium}}</td>
                                        <td>{{subAssembly.oilTest.water}}</td>
                                        <td>{{subAssembly.oilTest.viscosity}}</td>
                                        </tbody>
                                    </table>
                                    <!--Oil Test Action Item-->
                                    <hr/>
                                    <h3>Action Item</h3>
                                    <table class="table">
                                        <thead>
                                        <th>Status</th>
                                        <th>Issue</th>
                                        <th>Action</th>
                                        <th>Technician</th>
                                        <th>Time Actioned</th>
                                        </thead>
                                        <tbody>
                                        <td>{{subAssembly.oilTest.actionItem.status}}</td>
                                        <td>{{subAssembly.oilTest.actionItem.issue}}</td>
                                        <td>{{subAssembly.oilTest.actionItem.action}}</td>
                                        <td>{{subAssembly.oilTest.actionItem.technician.name}}</td>
                                        <td>{{moment(subAssembly.oilTest.actionItem.timeActioned).format("dddd, MMMM Do YYYY,
                                            h:mm:ss a")}}
                                        </td>
                                        </tbody>
                                    </table>
                                    <div ng-app id="ng-subComment" class="panel panel-success"
                                         ng-repeat="comment in subAssembly.oilTest.comments">
                                        <div class="panel-heading">
                                            <a href="#" ng-model="collapsed" style="color:white" class="text-success"
                                               ng-click="collapsedComment=!collapsedComment">
                                                Comment by: {{comment.author.name}}
                                                <div class="panel-title pull-right">
                                                    Time Commented: {{moment(comment.timeCommented).format("dddd, MMMM Do YYYY,
                                                    h:mm:ss a")}}
                                                </div>
                                            </a>
                                        </div>
                                        <div ng-show="collapsedComment" class="panel-body">{{comment.text}}</div>
                                    </div>

                                    <!--Add a oil test comment -->
                                    <div add-comment location="oilTest" location-id="{{subAssembly.oilTest.id}}"></div>
                                </div>

                            </div>

                        </div>
                        <!-- Wear Test -->
                        <div ng-if="subAssembly.wearTest != null">
                            <div class="panel panel-warning">
                                <div class="panel-heading">Wear Test</div>
                                <div class="panel-body">
                                    <table class="table">
                                        <thead>
                                        <th>Description</th>
                                        <th>New</th>
                                        <th>Limit</th>
                                        <th>Life Lower</th>
                                        <th>Life Upper</th>
                                        <th>Time Tested</th>
                                        </thead>
                                        <tbody>
                                        <td>{{subAssembly.wearTest.description}}</td>
                                        <td>{{subAssembly.wearTest.new}}</td>
                                        <td>{{subAssembly.wearTest.limit}}</td>
                                        <td>{{subAssembly.wearTest.lifeLower}}</td>
                                        <td>{{subAssembly.wearTest.lifeUpper}}</td>
                                        <td>{{moment(subAssembly.wearTest.timeStart).format("dddd, MMMM Do YYYY, h:mm:ss a")}}
                                        </td>
                                        </tbody>
                                    </table>
                                    <h3/>
                                    <!-- Action Item-->
                                    <h3>Action Item</h3>
                                    <table class="table">
                                        <thead>
                                        <th>Status</th>
                                        <th>Issue</th>
                                        <th>Action</th>
                                        <th>Technician</th>
                                        <th>Time Actioned</th>
                                        </thead>
                                        <tbody>
                                        <td>{{subAssembly.wearTest.actionItem.status}}</td>
                                        <td>{{subAssembly.wearTest.actionItem.issue}}</td>
                                        <td>{{subAssembly.wearTest.actionItem.action}}</td>
                                        <td>{{subAssembly.wearTest.actionItem.technician.name}}</td>
                                        <td>{{moment(subAssembly.wearTest.actionItem.timeActioned).format("dddd, MMMM Do YYYY,
                                            h:mm:ss a")}}
                                        </td>
                                        </tbody>
                                    </table>
                                    <div ng-app id="ng-subComment" class="panel panel-success"
                                         ng-repeat="comment in subAssembly.wearTest.comments">
                                        <div class="panel-heading">
                                            <a href="#" ng-model="collapsed" style="color:white" class="text-success"
                                               ng-click="collapsedComment=!collapsedComment">
                                                Comment by: {{comment.author.name}}
                                                <div class="panel-title pull-right">
                                                    Time Commented: {{moment(comment.timeCommented).format("dddd, MMMM Do YYYY,
                                                    h:mm:ss a")}}
                                                </div>
                                            </a>
                                        </div>
                                        <div ng-show="collapsedComment" class="panel-body">{{comment.text}}</div>
                                    </div>

                                    <!--Add a wear test comment -->
                                    <div add-comment location="wearTest" location-id="{{subAssembly.wearTest.id}}"></div>

                                </div>
                            </div>
                        </div>
                        <!-- Sub Assembly Comments -->
                        <div ng-app id="ng-subComment" class="panel panel-success" ng-repeat="comment in subAssembly.comments">
                            <div class="panel-heading">
                                <a href="#" ng-model="collapsed" style="color:white" class="text-success"
                                   ng-click="collapsedComment=!collapsedComment">
                                    Comment by: {{comment.author.name}}
                                    <div class="panel-title pull-right">
                                        Time Commented: {{moment(comment.timeCommented).format("dddd, MMMM Do YYYY, h:mm:ss
                                        a")}}
                                    </div>
                                </a>
                            </div>
                            <div ng-show="collapsedComment" class="panel-body">{{comment.text}}</div>
                        </div>

                        <!--Add a sub assembly comment -->
                        <div add-comment location="subAssembly" location-id="{{subAssembly.id}}"></div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<pre>{{ inspection | json }}</pre>